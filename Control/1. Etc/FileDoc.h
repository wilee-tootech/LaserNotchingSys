// FileDoc.h: interface for the CFileDoc class.
//
//////////////////////////////////////////////////////////////////////

#if !defined(AFX_FILEDOC_H__549C1F06_BC44_11D5_AFD3_000021F6EA31__INCLUDED_)
#define AFX_FILEDOC_H__549C1F06_BC44_11D5_AFD3_000021F6EA31__INCLUDED_

#if _MSC_VER > 1000
#pragma once
#endif // _MSC_VER > 1000

class CFileDoc
{
public:
		// Opne()함수를 콜해야만 쓸수 있는 함수..
		//////////////////////////////////////////////////////////////////////////////
		// 
		//////////////////////////////////////////////////////////////////////////////
		BOOL Open(CString strFileName);

		//////////////////////////////////////////////////////////////////////////////
		// File의 경로를 포함한 file 이름에 숫자 덧붙이기. 
		// 예 ("abc.txt")로 Open시켰을 때..
		// (1) => "abc1.txt",  
		// (1,"000") => "abc001.txt", 
		// (1234,"000") => "abc1234.txt"
		//////////////////////////////////////////////////////////////////////////////
		CString GetFileNameAddNumber(int number, CString strFormat="");

		//////////////////////////////////////////////////////////////////////////////
		// 경로와 확장자를 포함한 파일이름
		//////////////////////////////////////////////////////////////////////////////
		CString GetFilePath();

		//////////////////////////////////////////////////////////////////////////////
		// 경로를 포함한 파일이름에서 Root만 얻기.
		//////////////////////////////////////////////////////////////////////////////
		CString GetRoot();

		//////////////////////////////////////////////////////////////////////////////
		// 경로를 포함한 파일이름에서 FileName & Ext 얻기.
		//////////////////////////////////////////////////////////////////////////////
		CString GetFileName();

		//////////////////////////////////////////////////////////////////////////////
		// 경로를 포함한 파일이름에서 FileName 얻기.
		//////////////////////////////////////////////////////////////////////////////
		CString GetFileTitle();

		//////////////////////////////////////////////////////////////////////////////
		// 화일 이름에서 FileExt 얻기.
		//////////////////////////////////////////////////////////////////////////////
		CString GetFileExt();

public:
		//////////////////////////////////////////////////////////////////////////////
		// 현재의 실행파일이 실행되어 있는 디렉토리 얻어내기..
		//////////////////////////////////////////////////////////////////////////////
		static CString GetExeDirectory();

		//////////////////////////////////////////////////////////////////////////////
		// 현재의 디폴트로 셋팅된 디렉토리 알아내기..
		//////////////////////////////////////////////////////////////////////////////
		static CString GetCurrentDirectory();

		//////////////////////////////////////////////////////////////////////////////
		// 현재의 디폴트로 디렉토리 셋팅하기..
		//////////////////////////////////////////////////////////////////////////////
		static void SetCurrentDirectory(CString strDirectory);

		//////////////////////////////////////////////////////////////////////////////
		// 텍스트 문장을 줄단위로 나누기 읽기.
		//////////////////////////////////////////////////////////////////////////////
		static int GetStringFromText(CString strFullText, CString* pLineBuffs, int nBuffSu);

		//////////////////////////////////////////////////////////////////////////////
		// 콤마로 이루어진 문장을 단어로 나누기.
		//////////////////////////////////////////////////////////////////////////////
		static int GetWordFromComma(CString strCommaString, CString* pWordBuff, int nBuffSu, char chSep = ',');

		//////////////////////////////////////////////////////////////////////////////
		// 텍스트 문장을 화일에 기록하기.
		//////////////////////////////////////////////////////////////////////////////
		static BOOL WriteTextToFile(CString strFileName, CString& Buff, BOOL bAttch=false);

		//////////////////////////////////////////////////////////////////////////////
		// 지정된 File로부터 텍스트 화일 읽어 Buff에 담기.
		//////////////////////////////////////////////////////////////////////////////
		static BOOL ReadTextFromFile(CString strFileName, CString& Buff);

		static int GetNumberOfLinesInFile(CString strFileName);
		//////////////////////////////////////////////////////////////////////////////
		// 경로안에 있는 폴더 이름들 얻기.
		//////////////////////////////////////////////////////////////////////////////
		static int GetFolders(CString& strFolders, CString strRoot);

		//////////////////////////////////////////////////////////////////////////////
		// 경로안에 있는 파일찾기.
		//////////////////////////////////////////////////////////////////////////////
		static int GetFiles(CString& strFileNames, CString strFilter="", CString strRoot="", BOOL bSubFolder=false);

		//////////////////////////////////////////////////////////////////////////////
		// 파일이 존재하냐 존재하지 않느냐
		//////////////////////////////////////////////////////////////////////////////
		static BOOL IsFileFind(CString strFileName);

		//////////////////////////////////////////////////////////////////////////////
		// 파일 지우기.
		//////////////////////////////////////////////////////////////////////////////
		static BOOL DeleteFile(CString strSrcFileName);

		//////////////////////////////////////////////////////////////////////////////
		// 파일 복사.
		//////////////////////////////////////////////////////////////////////////////
		static BOOL CopyFile(CString strSrcFileName, CString strTrgFileName, BOOL bForce=false);


protected:
	CString m_strFileRoot;
	CString m_strFileTitle;
	CString m_strFileExt;
	CString m_strFilePath;


public:
	CFileDoc();
	CFileDoc(CString fileName);
	virtual ~CFileDoc();
};

#endif // !defined(AFX_FILEDOC_H__549C1F06_BC44_11D5_AFD3_000021F6EA31__INCLUDED_)
